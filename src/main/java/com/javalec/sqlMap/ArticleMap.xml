<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="articleDao">
	
	<!-- 기사 목록 가져오기 -->
	<select id="getArticleList" resultType="Map" parameterType="Map" statementType="CALLABLE">
		<choose>
			<when test = "selectedCategory eq 0">
				SELECT * FROM
				(
					SELECT ROW_NUMBER() OVER (ORDER BY write_date) AS no, id, title, content, reporter, write_date, modify_date, keyword, like_count, FK_ArticleCategory
					FROM ARTICLE
				) a WHERE a.no BETWEEN #{start} AND #{end}
			</when>
			<otherwise>
				SELECT * FROM
				(
					SELECT ROW_NUMBER() OVER (ORDER BY write_date) AS no, id, title, content, reporter, write_date, modify_date, keyword, like_count, FK_ArticleCategory
					FROM ARTICLE
				) a WHERE a.no BETWEEN #{start} AND #{end} AND FK_ArticleCategory = #{selectedCategory} 
			</otherwise>
		</choose>
	</select>
	
	<select id="getArticleListCount" resultType="int" parameterType="Map" statementType="CALLABLE">
		<choose>
			<when test = "selectedCategory eq 0">
				SELECT COUNT(*) FROM ARTICLE
			</when>
			<otherwise>
				SELECT COUNT(*) FROM ARTICLE WHERE FK_ArticleCategory = #{selectedCategory}
			</otherwise>
		</choose>
	</select>
	
</mapper>